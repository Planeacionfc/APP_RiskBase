# üöÄ App RiskBase - Aplicativo web para la gesti√≥n de base riesgo

## üìã Descripci√≥n general  
APP_RiskBase es una aplicaci√≥n web especializada en la gesti√≥n integral de la base de riesgo de la organizaci√≥n. Su prop√≥sito es optimizar la extracci√≥n, transformaci√≥n, an√°lisis y reporte de datos provenientes de sistemas ERP, espec√≠ficamente SAP BW. La aplicaci√≥n permite calcular factores provisionales y clasificaciones de riesgo mediante reglas de negocio definidas, ofreciendo interfaces diferenciadas para usuarios regulares y administradores.

**Caracter√≠sticas Principales**:
  - **Integraci√≥n con SAP BW**: Utiliza la librer√≠a pyrfc para la conexi√≥n y extracci√≥n de datos desde SAP BW.
  -	**Procesamiento de Datos**: Implementa un pipeline ETL utilizando pandas y numpy para la transformaci√≥n y an√°lisis de los datos extra√≠dos.
  -	**C√°lculo de Riesgos**: Aplica reglas de negocio espec√≠ficas para determinar factores provisionales y clasificaciones de riesgo.
  -	**Interfaz de Usuario**: Desarrollada con React y Next.js, proporcionando una experiencia de usuario intuitiva y responsiva.
  -	**Gesti√≥n de Usuarios**: Implementa autenticaci√≥n basada en JWT y control de acceso por roles (user, admin).
  -	**Trazabilidad**: Registra y almacena los cambios realizados en las pol√≠ticas de riesgo para auditor√≠a y seguimiento.

## üéØ Objetivo general y alcance  
**Objetivo general**: Desarrollar e implementar una aplicaci√≥n web robusta, sostenible y escalable que optimice la gesti√≥n integral de la base de riesgo de la organizaci√≥n. Esta herramienta debe permitir:
  -	**Integraci√≥n eficiente con SAP BW**: Facilitar la extracci√≥n automatizada de datos relevantes mediante la librer√≠a pyrfc, asegurando una conexi√≥n segura y confiable con el sistema SAP BW.
  -	**Procesamiento avanzado de datos**: Aplicar un pipeline ETL utilizando pandas y numpy para transformar y analizar los datos extra√≠dos, permitiendo el c√°lculo preciso de factores provisionales y clasificaciones de riesgo.
  -	**Aplicaci√≥n de reglas de negocio din√°micas**: Implementar reglas de negocio espec√≠ficas para el c√°lculo de riesgos, utilizando el patr√≥n de dise√±o Strategy para permitir flexibilidad y escalabilidad en la l√≥gica de negocio.
  -	**Interfaz de usuario intuitiva y responsiva**: Desarrollar una interfaz de usuario con React y Next.js que proporcione una experiencia de usuario amigable, adaptada a diferentes dispositivos y resoluciones de pantalla.
  -	**Gesti√≥n de usuarios y control de acceso**: Implementar un sistema de autenticaci√≥n basado en JWT y control de acceso por roles (user, admin), garantizando la seguridad y confidencialidad de la informaci√≥n.
  -	**Trazabilidad y auditor√≠a de cambios**: Registrar y almacenar los cambios realizados en las pol√≠ticas de riesgo, permitiendo una auditor√≠a completa y seguimiento de las modificaciones.
   
**Alcance**:  
  -	**Automatizaci√≥n de Informes**: Reducci√≥n significativa del esfuerzo operativo necesario para la generaci√≥n de informes de la base de riesgo, mediante la automatizaci√≥n de procesos y generaci√≥n de archivos Excel con la informaci√≥n procesada.
  -	**Visualizaci√≥n de Datos**: Facilitar la interpretaci√≥n de la informaci√≥n mediante representaciones gr√°ficas y estructuradas, proporcionando dashboards interactivos y visualizaciones din√°micas.
  -	**Gesti√≥n de Pol√≠ticas de Riesgo**: Permitir la modificaci√≥n eficiente de los par√°metros de las pol√≠ticas de riesgo por parte de usuarios con rol de administrador, con registro de los cambios para auditor√≠a.
  -	**Almacenamiento Seguro de Informaci√≥n**: Garantizar el almacenamiento seguro de la informaci√≥n procesada en una base de datos relacional (SQL Server), utilizando SQLAlchemy como ORM para la gesti√≥n de datos.
  -	**Integraci√≥n con SAP BW**: Implementar una conexi√≥n segura y eficiente con SAP BW para la extracci√≥n de datos relevantes, utilizando la librer√≠a pyrfc.
  -	**Procesamiento y An√°lisis de Datos**: Aplicar un pipeline ETL utilizando pandas y numpy para la transformaci√≥n y an√°lisis de los datos extra√≠dos, permitiendo el c√°lculo preciso de factores provisionales y clasificaciones de riesgo.
  -	**Aplicaci√≥n de Reglas de Negocio**: Implementar reglas de negocio espec√≠ficas para el c√°lculo de riesgos, utilizando el patr√≥n de dise√±o Strategy para permitir flexibilidad y escalabilidad en la l√≥gica de negocio.
  -	**Gesti√≥n de Usuarios y Control de Acceso**: Implementar un sistema de autenticaci√≥n basado en JWT y control de acceso por roles (user, admin), garantizando la seguridad y confidencialidad de la informaci√≥n.
  -	**Trazabilidad y Auditor√≠a de Cambios**: Registrar y almacenar los cambios realizados en las pol√≠ticas de riesgo, permitiendo una auditor√≠a completa y seguimiento de las modificaciones.
  -	**Interfaz de Usuario Intuitiva y Responsiva**: Desarrollar una interfaz de usuario con React y Next.js que proporcione una experiencia de usuario amigable, adaptada a diferentes dispositivos y resoluciones de pantalla.

## üõ†Ô∏è Requisitos  
### ‚úÖ Funcionales  
**Extracci√≥n de datos SAP BW**
  -	Establecer una conexi√≥n segura con SAP BW mediante la librer√≠a pyrfc.
  -	Permitir la configuraci√≥n din√°mica de consultas RFC para extraer datos espec√≠ficos seg√∫n necesidades operativas.
  -	Validar la integridad y consistencia de los datos extra√≠dos antes del procesamiento.

**Procesamiento ETL de datos**
  -	Implementar pipelines de transformaci√≥n y carga (ETL) usando bibliotecas avanzadas como pandas y numpy.
  -	Transformar datos brutos extra√≠dos de SAP BW en formatos normalizados aptos para an√°lisis posterior.
  -	Automatizar el manejo de excepciones y errores en el pipeline de procesamiento.

**Aplicaci√≥n de reglas de negocio (Patr√≥n Strategy)**
  -	Implementar el patr√≥n de dise√±o Strategy para gestionar distintas pol√≠ticas y reglas de negocio: https://refactoring.guru/es/design-patterns/strategy.
  -	Permitir la creaci√≥n, modificaci√≥n y activaci√≥n din√°mica de distintas estrategias de c√°lculo de factores provisionales.
  -	Realizar la clasificaci√≥n autom√°tica del riesgo (bajo, medio, alto) seg√∫n reglas de negocio definidas.

**Autenticaci√≥n JWT y autorizaci√≥n por roles**
  -	Implementar un sistema robusto de autenticaci√≥n basado en JSON Web Tokens (JWT).
  -	Gestionar roles espec√≠ficos (user, admin), restringiendo funcionalidades y acceso a datos seg√∫n perfiles autorizados.
  -	Mantener sesiones seguras y persistentes mientras se garantizan las mejores pr√°cticas de seguridad.

**Generaci√≥n y manejo de informes Excel**
  -	Generar autom√°ticamente archivos Excel.
  -	Permitir almacenamiento temporal seguro de los archivos generados antes de la descarga por parte del usuario.

**Gesti√≥n de Usuarios y Roles**
  -	Permitir la creaci√≥n de usuarios mediante interfaz administrativa.
  -	Asignar roles espec√≠ficos con distintos niveles de acceso a funcionalidades y datos.
  -	Implementar validaciones en la gesti√≥n de usuarios para evitar inconsistencias o duplicidades.

**Gesti√≥n y Trazabilidad de Pol√≠ticas de Riesgo**
  -	Permitir modificaciones √°giles y seguras en los par√°metros que conforman las pol√≠ticas de riesgo.
  -	Registrar cada cambio realizado por los usuarios, con informaci√≥n detallada de, cu√°ndo y qu√© se modific√≥.
  -	Proporcionar una interfaz que permita modificar f√°cilmente la pol√≠tica de la base de riesgo.
 
### ‚ö†Ô∏è No funcionales  
**Rendimiento**
  -	Los tiempos de respuesta para la extracci√≥n y procesamiento de datos deben ser √≥ptimos.
  -	La interfaz de usuario debe cargar r√°pidamente, idealmente menos de 3 segundos en condiciones normales de red.

**Escalabilidad**
  -	Capacidad para gestionar el aumento en el volumen de datos extra√≠dos y procesados sin degradar significativamente el rendimiento.
  -	Arquitectura modular que permita agregar nuevas funcionalidades sin afectar las existentes.

**Seguridad**
  -	Aplicar est√°ndares modernos de seguridad para proteger datos sensibles.
  -	Autenticaci√≥n robusta mediante JWT y autorizaci√≥n precisa basada en roles definidos.
  -	Protecci√≥n contra vulnerabilidades comunes.

**Usabilidad**
  -	Interfaz intuitiva y amigable desarrollada con Next.js y React, compatible con dispositivos m√≥viles y distintos navegadores.
  -	Documentaci√≥n clara y accesible que facilite a los usuarios la operaci√≥n cotidiana del sistema.

**Mantenibilidad**
  -	C√≥digo estructurado, modular y debidamente documentado.
  -	Uso de metodolog√≠as y patrones est√°ndar como MVC, Strategy, y ETL.
  -	Facilitar la aplicaci√≥n √°gil de cambios futuros mediante documentaci√≥n t√©cnica clara.

**Disponibilidad**
  -	Garantizar una disponibilidad del sistema durante el horario laboral.
  -	Implementar procedimientos de recuperaci√≥n en caso de fallas (backup, restore, tolerancia a fallos).

**Compatibilidad**
  -	Asegurar compatibilidad total con SAP BW y las versiones actuales y futuras cercanas.
  -	Garantizar la compatibilidad con navegadores modernos y m√°s utilizados (Chrome, Edge, Firefox).

## ‚úîÔ∏è Criterios de aceptaci√≥n  
**Modelo de Base de Datos**
  -	Se validar√° mediante pruebas unitarias y de integraci√≥n que el modelo soporte todas las operaciones necesarias (CRUD, consultas complejas y auditor√≠a de cambios).

**Extracci√≥n de Datos desde SAP**
  -	La aplicaci√≥n deber√° establecer exitosamente conexiones RFC a SAP BW y extraer correctamente los datos necesarios seg√∫n consultas din√°micas.

**Procesamiento y Aplicaci√≥n de Reglas de Negocio**
  -	Se verificar√° mediante pruebas automatizadas que las reglas de negocio se aplican correctamente, utilizando distintas estrategias y escenarios predefinidos.
  -	Validar que los c√°lculos realizados coinciden con las reglas de negocio especificadas por la persona encargada de la base de riesgo.

**Autenticaci√≥n y Autorizaci√≥n**
  -	La autenticaci√≥n JWT funcionar√° correctamente, gestionando sesiones y tokens seguros.
  -	Las pruebas demostrar√°n que los permisos y accesos seg√∫n roles (user, admin) funcionan correctamente.

**Gesti√≥n de Informes Excel**
  -	La aplicaci√≥n generar√° correctamente los informes en formato Excel permitiendo la descarga √°gil y segura por parte del usuario.

**Interfaz de Usuario (Frontend)**
  -	Realizar pruebas de usuario que demuestren la usabilidad e intuici√≥n de la interfaz, validando el correcto funcionamiento del aplicativo.

**Trazabilidad y Gesti√≥n de Cambios**
  -	El sistema mantendr√° una bit√°cora clara y accesible de todos los cambios realizados en las pol√≠ticas de riesgo, mostrando, fecha/hora y detalle exacto de modificaciones.

**Rendimiento y Carga**
  -	Realizar pruebas de estr√©s y rendimiento que confirmen tiempos aceptables de carga y respuesta incluso bajo grandes vol√∫menes de datos.

**Seguridad del Sistema**
  -	Realizaci√≥n de pruebas de seguridad que garanticen protecci√≥n frente a vulnerabilidades comunes y validen el cumplimiento de est√°ndares de seguridad.

## üñ•Ô∏è Entorno de desarrollo  
### üêç Backend  
- **Lenguaje**: Python¬†3.11.8  
- **Frameworks**: FastAPI¬†(0.115.12), Django¬†(5.1.7)  
- **ORM / DB**: SQLAlchemy, pyodbc (SQL Server)  
- **SAP**: pyrfc¬†(3.3.1) 
- **Auth**: JWT (python‚Äëjose¬†v3.4.0), passlib¬†v1.7.4  
- **Librer√≠as**: pandas¬†v2.2.3, numpy¬†v2.2.4, openpyxl¬†v3.1.5, python‚Äëdotenv¬†v1.1.0, requests, cryptography, bcrypt‚Ä¶  
- **Servidor**: Uvicorn  
- **Dependencias**: requirements.txt :contentReference 

### üíª Frontend  
- **Lenguaje**: TypeScript  
- **Framework**: Next.js¬†(15.2.2)  
- **UI**: React¬†(19.1.0), Material¬†UI¬†(7.0.2), @mui/x-data-grid¬†(8.1.0), SweetAlert2¬†(11.19.1)  
- **Estilos**: TailwindCSS¬†(4.0.14), PostCSS¬†(8.5.3)  
- **Auth**: jwt‚Äëdecode¬†(4.0.0)  
- **Utilidades**: xlsx¬†(0.18.5), next-themes¬†(0.4.6)  
- **Dependencias**: package.json, package-lock.json

## üì¶ Instalaci√≥n y Configuraci√≥n

Sigue estos pasos para instalar y configurar el proyecto **APP_RiskBase** (Backend y Frontend) en un entorno local:

### Backend

1. Clonar el repositorio
```bash
git clone https://github.com/Planeacionfc/APP_RiskBase.git
cd APP_RiskBase/backend
```

2. Crear y activar un entorno virtual (recomendado)
```bash
# En Windows
python -m venv venv
venv\Scripts\activate

# En Linux/MacOS
python3 -m venv venv
source venv/bin/activate
```

3. Instalar dependencias
```bash
pip install -r requirements.txt
```

4. Configurar variables de entorno
```bash
cp .env.example .env
# Edita .env con tus credenciales de base de datos, SAP, API, etc.
```

5. Iniciar el backend
```bash
python run.py
```
El backend estar√° disponible en la URL y puerto configurados en tu archivo `.env` (por defecto http://127.0.0.1:8000).

6. Acceder a la documentaci√≥n interactiva
Abre tu navegador en:
- [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)

---

### Frontend

1. Ir a la carpeta del frontend
```bash
cd ../frontend
```

2. Instalar dependencias
```bash
npm install
```

3. Iniciar el frontend en modo desarrollo
```bash
npm run dev
```
El frontend estar√° disponible por defecto en [http://localhost:3000](http://localhost:3000)

> Si necesitas configurar variables de entorno, crea un archivo `.env` en la carpeta `frontend` y la carpeta `backend` con las variables necesarias. En el archivo `.env.example` puedes ver el ejemplo.

---

## üîó C√≥digo Fuente en GitHub
- Repositorio [https://github.com/Planeacionfc/APP_RiskBase](https://github.com/Planeacionfc/APP_RiskBase)
- Repositorio Backend: [https://github.com/Planeacionfc/APP_RiskBase/tree/master/backend](https://github.com/Planeacionfc/APP_RiskBase/tree/master/backend)
- Repositorio Frontend: [https://github.com/Planeacionfc/APP_RiskBase/tree/master/frontend](https://github.com/Planeacionfc/APP_RiskBase/tree/master/frontend)

---

üìã **Para m√°s informaci√≥n detallada sobre el proceso del aplicativo visita:**  [![Doc DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/Planeacionfc/APP_RiskBase)

